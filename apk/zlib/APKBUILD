# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=zlib
pkgver=1.3.1
pkgrel=10
pkgdesc="A compression/decompression Library"
arch="all"
license="Zlib"
url="https://zlib.net/"
subpackages="$pkgname-static $pkgname-dev $pkgname-doc"
source="https://github.com/madler/zlib/archive/refs/heads/develop.zip
	"
options="!check"
builddir="$srcdir"/zlib-develop

prepare() {
    default_prepare
    # 应用任何需要的补丁
}

build() {
    cd "$builddir"
    sed -e 's/1.3.1.2-audit/1.3.1.2/' -i zlib.h
	# we trade size for a little more speed.
	export CFLAGS="$CFLAGS -O2"
	CHOST="$CHOST" ./configure \
		--prefix=/usr \
		--shared
	make
}

package() {
    cd "$builddir"
    make DESTDIR="$pkgdir" install
    #ls -l "$pkgdir"/usr/lib
}

sha512sums="
9f9ef7a3143491db939bb9712eb6bef3fbd5b4e8ce4658dbba29941c5bd10bc91a9947d4a6612d838d7e07545ab1667ebab3fc9ba1e0d9540d941dc8188d61eb  develop.zip
"
